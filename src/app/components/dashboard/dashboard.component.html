<header class="main-header">
    <div class="header-info">
        <h1 class="page-title">Panor√°mica del Gimnasio</h1>
        <p class="page-subtitle">Indicadores clave de rendimiento y salud de tu comunidad</p>
    </div>
</header>

<div *ngIf="loading" class="loading-overlay">
    <div class="loader-premium"></div>
    <p>Analizando datos de los guerreros...</p>
</div>

<div *ngIf="!loading" class="dashboard-grid">
    <!-- Primary Stats Row -->
    <div class="stats-row">
        <div class="app-card stat-card primary">
            <div class="stat-icon-wrapper">üë•</div>
            <div class="stat-details">
                <span class="label">Total Guerrero</span>
                <span class="value">{{totalClients}}</span>
                <p class="trend-text">Miembros activos</p>
            </div>
        </div>

        <div class="app-card stat-card success" *ngIf="analytics">
            <div class="stat-icon-wrapper">üí∞</div>
            <div class="stat-details">
                <span class="label">Ingresos del Mes</span>
                <span class="value">{{analytics.total_revenue_month | currency}}</span>
                <p class="trend-text">{{analytics.check_ins_today}} ingresos hoy</p>
            </div>
        </div>

        <div class="app-card stat-card danger" *ngIf="stats">
            <div class="stat-icon-wrapper">‚åõ</div>
            <div class="stat-details">
                <span class="label">Acciones Urgentes</span>
                <span class="value">{{stats.upcoming_expirations}}</span>
                <p class="trend-text danger">Vencimientos pr√≥ximos</p>
            </div>
        </div>
    </div>

    <!-- Charts Row 1: Attendance & Revenue -->
    <div class="charts-row">
        <div class="app-card chart-card">
            <div class="chart-header">
                <h3>Tendencia de Asistencia</h3>
                <p>√öltimos 30 d√≠as</p>
            </div>
            <div class="chart-container">
                <ngx-charts-area-chart
                    [scheme]="colorScheme"
                    [results]="attendanceData"
                    [gradient]="true"
                    [xAxis]="true"
                    [yAxis]="true"
                    [legend]="false"
                    [showXAxisLabel]="false"
                    [showYAxisLabel]="false"
                    [autoScale]="true"
                    [curve]="curve">
                </ngx-charts-area-chart>
            </div>
        </div>

        <div class="app-card chart-card">
            <div class="chart-header">
                <h3>Flujo de Ingresos</h3>
                <p>Nuevas membres√≠as (30d)</p>
            </div>
            <div class="chart-container">
                <ngx-charts-bar-vertical
                    [scheme]="revenueColorScheme"
                    [results]="revenueData[0]?.series"
                    [gradient]="false"
                    [xAxis]="true"
                    [yAxis]="true"
                    [legend]="false"
                    [showXAxisLabel]="false"
                    [showYAxisLabel]="false">
                </ngx-charts-bar-vertical>
            </div>
        </div>
    </div>

    <!-- Charts Row 2 & Info -->
    <div class="analytics-content">
        <div class="charts-area">
            <div class="app-card chart-card distribution">
                <div class="chart-header">
                    <h3>Distribuci√≥n de Membres√≠as</h3>
                </div>
                <div class="chart-container pie-container">
                    <ngx-charts-pie-chart
                        [scheme]="colorScheme"
                        [results]="membershipTypeData"
                        [gradient]="true"
                        [legend]="true"
                        [legendPosition]="legendPosition"
                        [labels]="true"
                        [doughnut]="true">
                    </ngx-charts-pie-chart>
                </div>
            </div>
            <div class="app-card section-card">
                <div class="section-header">
                    <h3>Pr√≥ximas Expiraciones</h3>
                    <span class="badge warning">{{stats?.upcoming_expirations}} Cr√≠ticas</span>
                </div>
                <div class="expirations-list" *ngIf="stats?.upcoming_expirations_list?.length">
                    <div *ngFor="let m of stats?.upcoming_expirations_list" class="exp-item">
                        <div class="exp-info">
                            <span class="client-name">{{m.client_id}} (ID)</span>
                            <span class="expiry-date">Vence: {{m.end_date | date:'shortDate'}}</span>
                        </div>
                        <span class="status-pill warning">Pronto</span>
                    </div>
                </div>
                <div class="no-data" *ngIf="!stats?.upcoming_expirations_list?.length">
                    No hay membres√≠as por vencer en los pr√≥ximos d√≠as.
                </div>
            </div>
        </div>

        <div class="side-widgets">
            <div class="app-card profile-preview">
                <div class="avatar-large">PW</div>
                <h3>Staff Admin</h3>
                <p class="access-level">Nivel de Acceso: Superior</p>
                <div class="quick-actions">
                    <a routerLink="/clients" class="app-btn app-btn-secondary">Gestionar Socios</a>
                    <a routerLink="/memberships" class="app-btn app-btn-secondary">Ver Planes</a>
                </div>
            </div>
        </div>
    </div>
</div>
